<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MirSFlr Dashboard</title>
<link rel="icon" href="favicon-32x32.png">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root {
  --bg-dark:#0a1a2f;
  --bg-card:#14283a;
  --text-light:#fff;
  --flare-pink:#ff4081;
  --toggle-width:60px;
  --toggle-height:28px;
}
body {
  margin:0; font-family:Arial,sans-serif; color:var(--text-light); background: var(--bg-dark); text-align:center; transition:0.4s; position:relative; overflow-x:hidden;
}
#bgOverlay {position:fixed; inset:0; pointer-events:none; z-index:0; background: url('background.jpg') center/cover no-repeat; opacity:0.25;}
header {padding:3rem 2rem; position:relative; z-index:2;}
header img#logo {width:160px; margin-bottom:10px;}
header img.flare-icon {width:40px; margin-top:10px;}
header h1 {margin:0; font-size:2.8rem;}
header p.slogan {margin-top:0.5rem; color:var(--flare-pink); font-weight:bold;}
.theme-toggle-wrapper {position:fixed; top:20px; right:20px; z-index:10;}
.theme-toggle {position:relative; display:inline-block; width:var(--toggle-width); height:var(--toggle-height);}
.theme-toggle input {opacity:0; width:0; height:0;}
.slider {position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background-color:#555; border-radius:34px; transition:.4s;}
.slider:before {position:absolute; content:"üí°"; height:24px; width:24px; left:2px; bottom:2px; font-size:14px; display:flex; align-items:center; justify-content:center; border-radius:50%; background-color:var(--flare-pink); transition:.4s;}
input:checked + .slider { background-color:var(--flare-pink);}
input:checked + .slider:before {transform:translateX(32px); content:"üåô";}
.cards {display:flex; flex-direction:column; align-items:center; gap:20px; margin-top:2rem;}
.card {max-width:700px; width:90%; background: var(--bg-card); padding:2rem; border-radius:16px; box-shadow:0 8px 20px rgba(0,0,0,0.4); transition: transform 0.3s, box-shadow 0.3s; position: relative; overflow:hidden;}
.card:hover {transform: translateY(-8px); box-shadow:0 18px 40px rgba(255,64,129,0.4);}
.card h4 {margin:0 0 1rem; font-size:1.5rem;}
.card p {margin:0; line-height:1.6; color:#d1d9e6;}
.card .recap {position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); color:#fff; display:flex; align-items:center; justify-content:center; opacity:0; transition: transform 0.4s ease, opacity 0.4s ease; padding:1rem; font-size:0.95rem; text-align:center; transform: translateY(20px);}
.card:hover .recap {opacity:1; transform: translateY(0);}
.charts-grid {display:grid; grid-template-columns:1fr 1fr; gap:24px; padding:2rem; max-width:1200px; margin:0 auto;}
.chart-box {background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:1.5rem; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.5);}
canvas {width:100%!important; height:400px!important; border-radius:8px;}
.chart-box p {margin-top:0.8rem; color:#d1d9e6; font-size:0.9rem;}
footer {margin-top:2rem; padding:1.5rem; color: var(--flare-pink);}
footer a {color: var(--flare-pink); text-decoration:underline;}
footer img {width:20px; vertical-align:middle; filter: drop-shadow(0 0 5px var(--flare-pink)); margin-left:6px;}
@media(max-width:1000px){.charts-grid{grid-template-columns:1fr;}.card{width:95%;}}
</style>
</head>
<body>
<div id="bgOverlay"></div>
<div class="theme-toggle-wrapper">
<label class="theme-toggle"><input type="checkbox" id="themeToggle"><span class="slider"></span></label>
</div>

<header>
<img id="logo" src="logo.png" alt="MirSFlr Logo">
<h1>MirSFlr</h1>
<img class="flare-icon" src="flare-icon.png" alt="Flare Icon">
<p class="slogan">A trusted validator on the Flare Network</p>
</header>

<section id="roles">
<div class="cards">
<div class="card">
<h4>üîí Validators</h4>
<p>Validators operate full nodes, validate blocks, enforce consensus, and secure the Flare network. They earn FLR rewards for consistent performance and reliability.</p>
<div class="recap">Validators secure the network and earn FLR rewards.</div>
</div>
<div class="card">
<h4>ü§ù Delegators</h4>
<p>Delegators stake FLR tokens with validators, supporting network security. They earn rewards proportionally without needing to run a node themselves.</p>
<div class="recap">Delegators passively support validators and earn rewards.</div>
</div>
<div class="card">
<h4>üì° Providers</h4>
<p>Providers supply real-world data (oracles) to the Flare network for smart contracts. Accurate and timely data ensures reliable contract execution.</p>
<div class="recap">Providers supply crucial external data to the network.</div>
</div>
</div>
</section>

<section id="charts">
<h2 style="margin-bottom:1rem;">Live Metrics</h2>
<div class="charts-grid">
<div class="chart-box" style="grid-column:span 2;">
<h3>FLR Token Price (EUR)</h3>
<canvas id="priceChart"></canvas>
<p>Live FLR price from CoinGecko API via CORS proxy.</p>
</div>
<div class="chart-box">
<h3>Transactions (24h)</h3>
<canvas id="txChart"></canvas>
<p>Number of transactions executed in the Flare network in the past 24 hours.</p>
</div>
<div class="chart-box">
<h3>Active Validators</h3>
<canvas id="validatorsChart"></canvas>
<p>Current number of validators actively validating blocks.</p>
</div>
<div class="chart-box">
<h3>Stake / Delegations</h3>
<canvas id="stakeChart"></canvas>
<p>Distribution of delegated FLR tokens among validators and delegators.</p>
</div>
<div class="chart-box">
<h3>Network Activity (Last 10 Days)</h3>
<canvas id="activityChart"></canvas>
<p>Daily count of new validators and delegators over the last 10 days.</p>
</div>
</div>
</section>

<footer>
Email: <a href="mailto:svensekmir@gmail.com">svensekmir@gmail.com</a>
<img src="flare-icon.png" alt="Flare Icon">
</footer>

<script>
// Theme toggle
const themeCheckbox=document.getElementById('themeToggle');
themeCheckbox.addEventListener('change',()=>{document.body.classList.toggle('light-theme');});
if(localStorage.getItem('mir_theme')==='light'){document.body.classList.add('light-theme'); themeCheckbox.checked=true;}

// Chart initialization
const dummyLabels = Array.from({length:10}, (_,i)=>i+1);
function createLineChart(ctx, label, color){
  return new Chart(ctx,{type:'line', data:{labels:dummyLabels,datasets:[{label:label,data:Array(10).fill(0),borderColor:color,backgroundColor:color.replace(')',',0.2)').replace('rgb','rgba'),fill:true,tension:0.25,pointRadius:4}]} , options:{responsive:true,plugins:{legend:{display:true}},scales:{x:{display:true},y:{display:true}}}});
}
const priceChart = createLineChart(document.getElementById('priceChart').getContext('2d'),'FLR Price','rgb(255,64,129)');
const txChart = createLineChart(document.getElementById('txChart').getContext('2d'),'Transactions','rgb(30,144,255)');
const validatorsChart = createLineChart(document.getElementById('validatorsChart').getContext('2d'),'Active Validators','rgb(255,209,102)');
const stakeChart = createLineChart(document.getElementById('stakeChart').getContext('2d'),'Stake / Delegations','rgb(32,201,151)');
const activityChart = createLineChart(document.getElementById('activityChart').getContext('2d'),'Network Activity','rgb(255,140,0)');

// Fetch live FLR price via CORS proxy
async function fetchPrice(){
  try{
    const proxy='https://cors-anywhere.herokuapp.com/';
    const res=await fetch(proxy+'https://api.coingecko.com/api/v3/simple/price?ids=flare&vs_currencies=eur');
    const data=await res.json();
    const price = data.flare.eur;
    priceChart.data.datasets[0].data.push(price);
    priceChart.data.datasets[0].data.shift();
    priceChart.update();
  } catch(e){console.error(e);}
}
fetchPrice();
setInterval(fetchPrice,60000);

// Fetch live Flare metrics
async function fetchFlareData(){
  const proxy='https://cors-anywhere.herokuapp.com/';
  try{
    // Transactions
    const txRes=await fetch(proxy+'https://explorer-api.flare.network/api/transactions?limit=10');
    const txData=await txRes.json();
    txChart.data.datasets[0].data = txData.map(t=>t.count || 0); txChart.update();

    // Active Validators
    const vRes=await fetch(proxy+'https://explorer-api.flare.network/api/validators/active');
    const vData=await vRes.json();
    validatorsChart.data.datasets[0].data = [vData.length]; validatorsChart.update();

    // Stake / Delegations
    const sRes=await fetch(proxy+'https://explorer-api.flare.network/api/stake');
    const sData=await sRes.json();
    stakeChart.data.datasets[0].data = [sData.validators_total, sData.delegators_total]; stakeChart.update();

    // Network Activity
    const nRes=await fetch(proxy+'https://explorer-api.flare.network/api/network-activity?days=10');
    const nData=await nRes.json();
    activityChart.data.datasets[0].data = nData.map(d=>d.new_validators+d.new_delegators); activityChart.update();
  }catch(e){console.error(e);}
}
fetchFlareData();
setInterval(fetchFlareData,60000);
</script>
</body>
</html>
